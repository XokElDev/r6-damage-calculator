<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R6 Damage Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tab-btn.active {
            background-color: #0891b2; /* color de cyan-600 */
            color: white;
        }
        .flag-icon {
            cursor: pointer;
            width: 56px; /* Adjusted for two flags */
            height: 24px;
            border-radius: 4px;
            transition: transform 0.2s;
            border: 2px solid transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .flag-icon:hover {
            transform: scale(1.1);
        }
        .flag-icon.active {
            border-color: #22d3ee; /* cyan-400 */
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-4xl bg-gray-800 rounded-xl shadow-2xl p-6 md:p-8">
        
        <div class="flex flex-col md:flex-row md:justify-between md:items-start mb-8">
             <div class="text-left mb-4 md:mb-0">
                <h1 data-lang-key="title" class="text-3xl md:text-4xl font-bold text-cyan-400">R6 Damage Calculator</h1>
                <p data-lang-key="subtitle" class="text-gray-400 mt-2">Compara el da√±o base con el da√±o aumentado en diferentes escenarios.</p>
            </div>
            <div id="language-switcher" class="flex space-x-2">
                <!-- Flags will be injected here -->
            </div>
        </div>

        <!-- Input Form -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
                <label for="rawDamage" data-lang-key="raw_damage_label" class="block text-sm font-medium text-gray-300 mb-2">Da√±o Base (Raw)</label>
                <input type="number" id="rawDamage" placeholder="Ej: 26" class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition">
            </div>
            <div>
                <label for="augmentedDamage" data-lang-key="augmented_damage_label" class="block text-sm font-medium text-gray-300 mb-2">Da√±o Aumentado</label>
                <input type="number" id="augmentedDamage" placeholder="Ej: 29" class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition">
            </div>
        </div>
        
        <button id="calculateBtn" data-lang-key="calculate_button" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 shadow-lg">
            Calcular
        </button>

        <!-- Error Message -->
        <div id="error-message" class="mt-4 text-center text-red-400 font-medium hidden"></div>

        <!-- Tabs Container -->
        <div id="tabs-container" class="mt-8 hidden">
            <h3 data-lang-key="tabs_header" class="text-center text-sm font-semibold text-gray-400 mb-3 uppercase tracking-wider"></h3>
            <nav class="flex flex-col md:flex-row md:justify-around w-full md:border-b md:border-gray-700 md:-mb-px" aria-label="Tabs">
                <!-- Tabs will be dynamically generated -->
            </nav>
        </div>

        <!-- Content Panels -->
        <div id="content-panels" class="mt-6">
            <!-- Dynamically generated content will go here -->
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const calculateBtn = document.getElementById('calculateBtn');
            const rawDamageInput = document.getElementById('rawDamage');
            const augmentedDamageInput = document.getElementById('augmentedDamage');
            const errorMessageDiv = document.getElementById('error-message');
            const tabsContainer = document.getElementById('tabs-container');
            const contentPanelsContainer = document.getElementById('content-panels');
            const languageSwitcherDiv = document.getElementById('language-switcher');
            
            // --- Data & State ---
            const translations = {
                es: {
                    title: "R6 Damage Calculator",
                    subtitle: "Compara el da√±o en diferentes escenarios del <strong class='text-cyan-400'>Ca√±on Extendido</strong> introduciendo el da√±o base del arma y el da√±o aumentado con el ca√±on que aparecen en el juego.",
                    raw_damage_label: "Da√±o Base (Raw)",
                    augmented_damage_label: "Da√±o Aumentado",
                    calculate_button: "Calcular",
                    error_positive_values: "Por favor, introduce valores de da√±o v√°lidos y positivos.",
                    error_augmented_greater: "El da√±o aumentado debe ser mayor que el da√±o base.",
                    results_title: "Resultados",
                    detailed_analysis_title: "An√°lisis Detallado",
                    operator_hp: "Operador (HP)",
                    shots_base: "Disparos (Base)",
                    shots_augmented: "Disparos (Aumentado)",
                    improvement: "Mejora",
                    exact_shots_base: "Disparos Exactos (Base)",
                    exact_shots_augmented: "Disparos Exactos (Aumentado)",
                    difference: "Diferencia",
                    fast_op: "R√°pido (100 HP)",
                    medium_op: "Medio (110 HP)",
                    slow_op: "Lento (125 HP)",
                    body_short: "Cuerpo (Corta)",
                    body_long: "Cuerpo (Larga)",
                    limbs_short: "Extremidades (Corta)",
                    limbs_long: "Extremidades (Larga)",
                    tabs_header: "Cuerpo / Extremidades (Distancia)"
                },
                en: {
                    title: "R6 Damage Calculator",
                    subtitle: "Compare the damage in different scenarios with the <strong class='text-cyan-400'>Extended Barrel</strong> by entering the weapon's base damage and the augmented damage with the barrel shown in the game.",
                    raw_damage_label: "Base Damage (Raw)",
                    augmented_damage_label: "Augmented Damage",
                    calculate_button: "Calculate",
                    error_positive_values: "Please enter valid, positive damage values.",
                    error_augmented_greater: "Augmented damage must be greater than base damage.",
                    results_title: "Results",
                    detailed_analysis_title: "Detailed Analysis",
                    operator_hp: "Operator (HP)",
                    shots_base: "Shots (Base)",
                    shots_augmented: "Shots (Augmented)",
                    improvement: "Improvement",
                    exact_shots_base: "Exact Shots (Base)",
                    exact_shots_augmented: "Exact Shots (Augmented)",
                    difference: "Difference",
                    fast_op: "Fast (100 HP)",
                    medium_op: "Medium (110 HP)",
                    slow_op: "Slow (125 HP)",
                    body_short: "Body (Short)",
                    body_long: "Body (Long)",
                    limbs_short: "Limbs (Short)",
                    limbs_long: "Limbs (Long)",
                    tabs_header: "Body / Limbs (Distance)"
                },
                fr: {
                    title: "Calculateur de D√©g√¢ts R6",
                    subtitle: "Comparez les d√©g√¢ts dans diff√©rents sc√©narios avec le <strong class='text-cyan-400'>Canon Allong√©</strong> en saisissant les d√©g√¢ts de base de l'arme et les d√©g√¢ts augment√©s avec le canon affich√©s dans le jeu.",
                    raw_damage_label: "D√©g√¢ts de Base (Raw)",
                    augmented_damage_label: "D√©g√¢ts Augment√©s",
                    calculate_button: "Calculer",
                    error_positive_values: "Veuillez entrer des valeurs de d√©g√¢ts valides et positives.",
                    error_augmented_greater: "Les d√©g√¢ts augment√©s doivent √™tre sup√©rieurs aux d√©g√¢ts de base.",
                    results_title: "R√©sultats",
                    detailed_analysis_title: "Analyse D√©taill√©e",
                    operator_hp: "Op√©rateur (PV)",
                    shots_base: "Tirs (Base)",
                    shots_augmented: "Tirs (Augment√©)",
                    improvement: "Am√©lioration",
                    exact_shots_base: "Tirs Exacts (Base)",
                    exact_shots_augmented: "Tirs Exacts (Augment√©)",
                    difference: "Diff√©rence",
                    fast_op: "Rapide (100 PV)",
                    medium_op: "Moyen (110 PV)",
                    slow_op: "Lent (125 PV)",
                    body_short: "Corps (Courte)",
                    body_long: "Corps (Longue)",
                    limbs_short: "Membres (Courte)",
                    limbs_long: "Membres (Longue)",
                    tabs_header: "Corps / Membres (Distance)"
                },
                de: {
                    title: "R6 Schadensrechner",
                    subtitle: "Vergleichen Sie den Schaden in verschiedenen Szenarien mit dem <strong class='text-cyan-400'>Verl√§ngerten Lauf</strong>, indem Sie den Basisschaden der Waffe und den erh√∂hten Schaden mit dem im Spiel angezeigten Lauf eingeben.",
                    raw_damage_label: "Basisschaden (Raw)",
                    augmented_damage_label: "Erh√∂hter Schaden",
                    calculate_button: "Berechnen",
                    error_positive_values: "Bitte geben Sie g√ºltige, positive Schadenswerte ein.",
                    error_augmented_greater: "Erh√∂hter Schaden muss gr√∂√üer sein als Basisschaden.",
                    results_title: "Ergebnisse",
                    detailed_analysis_title: "Detaillierte Analyse",
                    operator_hp: "Operator (LP)",
                    shots_base: "Sch√ºsse (Basis)",
                    shots_augmented: "Sch√ºsse (Erh√∂ht)",
                    improvement: "Verbesserung",
                    exact_shots_base: "Exakte Sch√ºsse (Basis)",
                    exact_shots_augmented: "Exakte Sch√ºsse (Erh√∂ht)",
                    difference: "Unterschied",
                    fast_op: "Schnell (100 LP)",
                    medium_op: "Mittel (110 LP)",
                    slow_op: "Langsam (125 LP)",
                    body_short: "K√∂rper (Kurz)",
                    body_long: "K√∂rper (Lang)",
                    limbs_short: "Gliedma√üen (Kurz)",
                    limbs_long: "Gliedma√üen (Lang)",
                    tabs_header: "K√∂rper / Gliedma√üen (Distanz)"
                }
            };
            
            const languages = [
                { code: 'es', flag: 'üá™üá∏', country: 'Spain' },
                { code: 'en', flag: 'üá∫üá∏üá¨üáß', country: 'English' },
                { code: 'fr', flag: 'üá´üá∑', country: 'France' },
                { code: 'de', flag: 'üá©üá™', country: 'Germany' }
            ];

            const damageScenarios = [
                { id: '100', nameKey: 'body_short', multiplier: 1.0, percentage: '100%' },
                { id: '70', nameKey: 'body_long', multiplier: 0.7, percentage: '70%' },
                { id: '50', nameKey: 'limbs_short', multiplier: 0.5, percentage: '50%' },
                { id: '30', nameKey: 'limbs_long', multiplier: 0.3, percentage: '30%' }
            ];

            const operatorHPKeys = {
                fast_op: 100.0,
                medium_op: 110.0,
                slow_op: 125.0
            };
            
            const eyeOpenSVG = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>`;
            const eyeClosedSVG = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7 1.274-4.057 5.064-7 9.542-7 .847 0 1.67.127 2.455.364m0 18.461A10.05 10.05 0 0012 19c-4.478 0-8.268-2.943-9.542-7 1.274-4.057 5.064-7 9.542-7 1.725 0 3.35.416 4.785 1.155M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M3 3l18 18" /></svg>`;

            // --- Language Initialization ---
            const getInitialLanguage = () => {
                const browserLang = (navigator.language || navigator.userLanguage).slice(0, 2);
                const isSupported = languages.some(lang => lang.code === browserLang);
                return isSupported ? browserLang : 'en'; // Default to English
            };
            let currentLanguage = getInitialLanguage();

            // --- Functions ---
            const changeLanguage = (lang) => {
                currentLanguage = lang;
                document.documentElement.lang = lang;
                document.querySelectorAll('[data-lang-key]').forEach(el => {
                    const key = el.dataset.langKey;
                    if (translations[lang][key]) {
                        el.innerHTML = translations[lang][key];
                    }
                });
                
                if (!tabsContainer.classList.contains('hidden')) {
                    calculateAndRender();
                }
                updateActiveFlag();
            };

            const initLanguageSwitcher = () => {
                let html = '';
                languages.forEach(lang => {
                    html += `<span class="flag-icon" data-lang="${lang.code}" title="${lang.country}">${lang.flag}</span>`;
                });
                languageSwitcherDiv.innerHTML = html;
                languageSwitcherDiv.querySelectorAll('.flag-icon').forEach(flag => {
                    flag.addEventListener('click', () => changeLanguage(flag.dataset.lang));
                });
                updateActiveFlag();
            };
            
            const updateActiveFlag = () => {
                 languageSwitcherDiv.querySelectorAll('.flag-icon').forEach(flag => {
                    flag.classList.toggle('active', flag.dataset.lang === currentLanguage);
                });
            };

            const calculateAndRender = () => {
                const rawDmg = parseInt(rawDamageInput.value);
                const augDmg = parseInt(augmentedDamageInput.value);

                if (isNaN(rawDmg) || isNaN(augDmg) || rawDmg <= 0 || augDmg <= 0) {
                    showError(translations[currentLanguage].error_positive_values);
                    return;
                }
                if (augDmg <= rawDmg) {
                    showError(translations[currentLanguage].error_augmented_greater);
                    return;
                }
                hideError();
                
                let tabsHTML = '';
                damageScenarios.forEach(scenario => {
                    const name = translations[currentLanguage][scenario.nameKey];
                    tabsHTML += `<button class="tab-btn whitespace-nowrap py-3 px-2 border-b-2 font-medium text-sm border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-500 flex-grow md:flex-grow-0 w-full md:w-auto mb-1 md:mb-0 rounded-md md:rounded-none" data-target="content-${scenario.id}">${name}</button>`;
                });
                tabsContainer.querySelector('nav').innerHTML = tabsHTML;

                let panelsHTML = '';
                damageScenarios.forEach(scenario => {
                    let resultsTableHTML = '';
                    let resultsCardsHTML = '';
                    let detailsTableHTML = '';
                    let detailsCardsHTML = '';
                    const modifiedRawDmg = rawDmg * scenario.multiplier;
                    const modifiedAugDmg = augDmg * scenario.multiplier;

                    for (const [opKey, hp] of Object.entries(operatorHPKeys)) {
                        const shotsRaw = Math.ceil(hp / modifiedRawDmg);
                        const shotsAugmented = Math.ceil(hp / modifiedAugDmg);
                        const hasBenefit = Math.floor(hp / modifiedRawDmg) !== Math.floor(hp / modifiedAugDmg);
                        const operatorName = translations[currentLanguage][opKey];
                        
                        const benefitIcon = hasBenefit
                            ? `<span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-green-500/20 text-green-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg></span>`
                            : `<span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-red-500/20 text-red-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.697a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></span>`;
                        
                        // Desktop Table Rows
                        resultsTableHTML += `<tr class="border-b border-gray-800 last:border-b-0"><td class="p-4 font-medium text-gray-200">${operatorName}</td><td class="p-4 text-center text-lg font-semibold text-gray-200">${shotsRaw}</td><td class="p-4 text-center text-lg font-semibold ${hasBenefit ? 'text-cyan-400' : 'text-gray-200'}">${shotsAugmented}</td><td class="p-4 flex justify-center items-center">${benefitIcon}</td></tr>`;
                        
                        // Mobile Card Views
                        resultsCardsHTML += `<div class="bg-gray-700 rounded-lg p-4 mb-3"><h4 class="font-bold text-lg text-cyan-400">${operatorName}</h4><div class="mt-2 grid grid-cols-2 gap-x-4 gap-y-2"><div class="text-gray-400">${translations[currentLanguage].shots_base}</div><div class="text-lg font-semibold text-right">${shotsRaw}</div><div class="text-gray-400">${translations[currentLanguage].shots_augmented}</div><div class="text-lg font-semibold text-right ${hasBenefit ? 'text-cyan-400' : ''}">${shotsAugmented}</div><div class="text-gray-400 col-span-1">${translations[currentLanguage].improvement}</div><div class="flex justify-end col-span-1">${benefitIcon}</div></div></div>`;

                        const exactShotsRaw = hp / modifiedRawDmg;
                        const exactShotsAugmented = hp / modifiedAugDmg;
                        
                        // Desktop Details Table Rows
                        detailsTableHTML += `<tr class="border-b border-gray-800 last:border-b-0"><td class="p-4 font-medium text-gray-200">${operatorName}</td><td class="p-4 text-center text-lg font-mono text-gray-200">${exactShotsRaw.toFixed(3)}</td><td class="p-4 text-center text-lg font-mono ${hasBenefit ? 'text-cyan-400' : 'text-gray-200'}">${exactShotsAugmented.toFixed(3)}</td><td class="p-4 text-center text-lg font-mono text-yellow-400">${(exactShotsRaw - exactShotsAugmented).toFixed(3)}</td></tr>`;
                        
                        // Mobile Details Card Views
                        detailsCardsHTML += `<div class="bg-gray-700 rounded-lg p-4 mb-3"><h4 class="font-bold text-lg text-cyan-400">${operatorName}</h4><div class="mt-2 grid grid-cols-2 gap-x-4 gap-y-2"><div class="text-gray-400">${translations[currentLanguage].exact_shots_base}</div><div class="text-lg font-mono text-right">${exactShotsRaw.toFixed(3)}</div><div class="text-gray-400">${translations[currentLanguage].exact_shots_augmented}</div><div class="text-lg font-mono text-right ${hasBenefit ? 'text-cyan-400' : ''}">${exactShotsAugmented.toFixed(3)}</div><div class="text-gray-400">${translations[currentLanguage].difference}</div><div class="text-lg font-mono text-yellow-400 text-right">${(exactShotsRaw - exactShotsAugmented).toFixed(3)}</div></div></div>`;
                    }
                    
                    panelsHTML += `
                        <div id="content-${scenario.id}" class="tab-content hidden">
                            <div class="results">
                                <h2 class="text-2xl font-semibold text-center mb-4">${translations[currentLanguage].results_title}</h2>
                                <div class="overflow-x-auto rounded-lg hidden md:block"><table class="min-w-full bg-gray-700"><thead class="bg-gray-900/50"><tr><th class="p-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].operator_hp}</th><th class="p-4 text-center text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].shots_base}</th><th class="p-4 text-center text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].shots_augmented}</th><th class="p-4 text-center text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].improvement}</th></tr></thead><tbody>${resultsTableHTML}</tbody></table></div>
                                <div class="block md:hidden">${resultsCardsHTML}</div>
                            </div>
                            <div class="details mt-6">
                                <div class="flex justify-center items-center mb-4"><h2 class="text-2xl font-semibold">${translations[currentLanguage].detailed_analysis_title}</h2><button class="toggle-details-btn ml-4 text-gray-400 hover:text-white">${eyeOpenSVG}</button></div>
                                <div class="overflow-x-auto rounded-lg hidden md:block"><table class="min-w-full bg-gray-700"><thead class="bg-gray-900/50"><tr><th class="p-4 text-left text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].operator_hp}</th><th class="p-4 text-center text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].exact_shots_base}</th><th class="p-4 text-center text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].exact_shots_augmented}</th><th class="p-4 text-center text-sm font-semibold text-gray-300 uppercase tracking-wider">${translations[currentLanguage].difference}</th></tr></thead><tbody>${detailsTableHTML}</tbody></table></div>
                                <div class="block md:hidden">${detailsCardsHTML}</div>
                            </div>
                        </div>`;
                });

                contentPanelsContainer.innerHTML = panelsHTML;
                tabsContainer.classList.remove('hidden');

                tabsContainer.querySelector('.tab-btn').click();
            };

            const handleEnterKey = (event) => {
                if (event.key === 'Enter') {
                    calculateBtn.click();
                }
            };
            
            const showError = (message) => {
                errorMessageDiv.textContent = message;
                errorMessageDiv.classList.remove('hidden');
                tabsContainer.classList.add('hidden');
                contentPanelsContainer.innerHTML = '';
            };

            const hideError = () => {
                errorMessageDiv.classList.add('hidden');
            };

            // --- Event Listeners ---
            calculateBtn.addEventListener('click', calculateAndRender);
            rawDamageInput.addEventListener('keyup', handleEnterKey);
            augmentedDamageInput.addEventListener('keyup', handleEnterKey);

            tabsContainer.addEventListener('click', (e) => {
                const button = e.target.closest('.tab-btn');
                if (button) {
                    tabsContainer.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    contentPanelsContainer.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                    const targetId = button.dataset.target;
                    document.getElementById(targetId).classList.remove('hidden');
                }
            });

            contentPanelsContainer.addEventListener('click', (e) => {
                const button = e.target.closest('.toggle-details-btn');
                if (button) {
                    const detailsDiv = button.closest('.details');
                    const tables = detailsDiv.querySelectorAll('.overflow-x-auto, .block.md\\:hidden');
                    let isHidden = false;
                    tables.forEach(el => {
                        isHidden = el.classList.toggle('hidden');
                    });
                    button.innerHTML = isHidden ? eyeClosedSVG : eyeOpenSVG;
                }
            });

            // --- Initialization ---
            initLanguageSwitcher();
            changeLanguage(currentLanguage);
        });
    </script>
</body>
</html>

